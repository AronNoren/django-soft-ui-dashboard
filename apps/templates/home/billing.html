<!DOCTYPE html>
<html>
<head>
    <title>Chat with AI</title>
</head>
<body>
    <h1>Chat with AI</h1>

    <div id="chat-container">
        <div id="messages"></div>

        <form id="message-form">
            <input type="text" name="message" placeholder="Type your message here...">
            <button type="submit">Send</button>
        </form>
    </div>

    <script>
        const messagesContainer = document.querySelector('#messages');
const messageForm = document.querySelector('#message-form');

messageForm.addEventListener('submit', event => {
    event.preventDefault();

    const messageInput = messageForm.querySelector('[name="message"]');
    const messageText = messageInput.value;

    // Send message to server
    fetch(`api/chat?message=${messageText}`)
        .then(response => {
            response.text().then(text => console.log(text));
            console.log(response)
            // Check if response is valid JSON
            if (!response.ok || !response.headers.get('content-type').includes('application/json')) {
                throw new Error('Unexpected response from server');
            }

            return response.json();
        })
        .then(data => {
            // Display AI response
            const aiMessage = document.createElement('div');
            aiMessage.classList.add('message', 'ai');
            aiMessage.textContent = data.message;

            messagesContainer.appendChild(aiMessage);
        })
        .catch(error => {
            
            console.error(error);

            // Display error message
            const errorMessage = document.createElement('div');
            errorMessage.classList.add('message', 'error');
            errorMessage.textContent = 'An error occurred. Please try again later.';

            messagesContainer.appendChild(errorMessage);
        });

    // Clear input field
    messageInput.value = '';
});

    </script>
</body>
</html>
