{% extends 'layouts/base.html' %}

{% block title %} Billing {% endblock title %}

<!-- Specific CSS goes HERE -->
{% block stylesheets %}
{% endblock stylesheets %}

{% block content %}

  <div class="container-fluid py-4">
<div id="chat">
</div>

<form id="chatForm">
    {% csrf_token %}
    <input id="userInput" type="text">
    <button type="submit">Send</button>
</form>

<script>
    $('#chatForm').on('submit', function(e) {
        e.preventDefault();

        let userMessage = $('#userInput').val();
        $('#chat').append(`<p>You: ${userMessage}</p>`);
        
        $.ajax({
            url: '{% url "chat" %}',
            method: 'POST',
            data: { message: userMessage },
            success: function(data) {
                $('#chat').append(`<p>AI: ${data.reply}</p>`);
            },
            error: function(err) {
                console.error(err);
                $('#chat').append(`<p>AI: I'm sorry, I couldn't understand that.</p>`);
            }
        });

        $('#userInput').val('');
    });
</script>
</html>

      {% include "includes/footer.html" %}

  </div>


{% endblock content %}

<!-- Specific JS goes HERE --> 
{% block javascripts %}
{% endblock javascripts %}
