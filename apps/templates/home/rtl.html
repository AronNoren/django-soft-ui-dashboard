{% extends 'layouts/base.html' %}

{% block title %} Dashboard {% endblock title %}

<!-- Specific CSS goes HERE -->
{% block stylesheets %}{% endblock stylesheets %}

{% block content %}

 <div class="container-fluid py-4">

     

      <div class="row mt-4">
        <div class="col-lg-7">
          <div class="card z-index-2">
            <div class="card-header pb-0">
              <h6>Sales overview</h6>
              <p class="text-sm">
                <i class="fa fa-arrow-up text-success"></i>
                <span class="font-weight-bold">4% more</span> in 2021
              </p>
            </div>
            <div class="card-body p-3">
              <div class="chart">
                <canvas id="chart-line" class="chart-canvas" height="300"></canvas>
              </div>
            </div>
          </div>
        </div>
      </div>



      {% include "includes/footer.html" %}

    </div>

 {% endblock content %}

<!-- Specific JS goes HERE --> 
{% block javascripts %}
  <script src="{{ ASSETS_ROOT }}/js/plugins/chartjs.min.js"></script>
  <script>  

            const modelName = 'portfolio'
            const token = localStorage.getItem('token') || ''
   
            let displayList = [];
            let displayList_name = [];
            let displayList_buy = [];
            let displayList_weight = [];
            let displayList_returns = [];
            let displayList_amount = [];
            fetch('https://sea-lion-app-ydqoo.ondigitalocean.app/api/portfolio/',{
             method: 'GET',
             headers: {
            'Authorization': `token ${token}`
             }
             })
            .then(function(response){
                return response.json()
            })
            .then((res) => {
                data = res.data
                
                res.data.forEach((item) => {
                    displayList.push(item.token);
                    displayList_name.push(item.token);
                    displayList_buy.push(item.buy);
                    displayList_returns.push(item.current);
                    displayList_weight.push(item.weight);
                    displayList_amount.push(item.amount);
                })
                document.getElementById("r1name").innerHTML = displayList_name[0];
                document.getElementById("r1price").innerHTML = displayList_buy[0];
                document.getElementById("r1weight").innerHTML = displayList_weight[0];
                document.getElementById("r1amount").innerHTML = displayList_amount[0];
                document.getElementById("r1stop").innerHTML = "10%";
                document.getElementById("r1current").innerHTML = displayList_returns[0];
                
                document.getElementById("r2name").innerHTML = displayList_name[1];
                document.getElementById("r2price").innerHTML = displayList_buy[1];
                document.getElementById("r2weight").innerHTML = displayList_weight[1];
                document.getElementById("r2amount").innerHTML = displayList_amount[1];
                document.getElementById("r2stop").innerHTML = "10%";
                document.getElementById("r2current").innerHTML = displayList_returns[1];
              
                document.getElementById("r3name").innerHTML = displayList_name[2];
                document.getElementById("r3price").innerHTML = displayList_buy[2];
                document.getElementById("r3weight").innerHTML = displayList_weight[2];
                document.getElementById("r3amount").innerHTML = displayList_amount[2];
                document.getElementById("r3stop").innerHTML = "10%";
                document.getElementById("r3current").innerHTML = displayList_returns[2];
              
                document.getElementById("r4name").innerHTML = displayList_name[3];
                document.getElementById("r4price").innerHTML = displayList_buy[3];
                document.getElementById("r4weight").innerHTML = displayList_weight[3];
                document.getElementById("r4amount").innerHTML = displayList_amount[3];
                document.getElementById("r4stop").innerHTML = "10%";
                document.getElementById("r4current").innerHTML = displayList_returns[3];
              
                document.getElementById("r5name").innerHTML = displayList_name[4];
                document.getElementById("r5price").innerHTML = displayList_buy[4];
                document.getElementById("r5weight").innerHTML = displayList_weight[4];
                document.getElementById("r5amount").innerHTML = displayList_amount[4];
                document.getElementById("r5stop").innerHTML = "10%";
                document.getElementById("r5current").innerHTML = displayList_returns[4];
              
                document.getElementById("r6name").innerHTML = displayList_name[5];
                document.getElementById("r6price").innerHTML = displayList_buy[5];
                document.getElementById("r6weight").innerHTML = displayList_weight[5];
                document.getElementById("r6amount").innerHTML = displayList_amount[5];
                document.getElementById("r6stop").innerHTML = "10%";
                document.getElementById("r6current").innerHTML = displayList_returns[5];
              
                document.getElementById("r7name").innerHTML = displayList_name[6];
                document.getElementById("r7price").innerHTML = displayList_buy[6];
                document.getElementById("r7weight").innerHTML = displayList_weight[6];
                document.getElementById("r7amount").innerHTML = displayList_amount[6];
                document.getElementById("r7stop").innerHTML = "10%";
                document.getElementById("r7current").innerHTML = displayList_returns[6];
             
                document.getElementById("r8name").innerHTML = displayList_name[7];
                document.getElementById("r8price").innerHTML = displayList_buy[7];
                document.getElementById("r8weight").innerHTML = displayList_weight[7];
                document.getElementById("r8amount").innerHTML = displayList_amount[7];
                document.getElementById("r8stop").innerHTML = "10%";
                document.getElementById("r8current").innerHTML = displayList_returns[7];
              
                document.getElementById("r9name").innerHTML = displayList_name[8];
                document.getElementById("r9price").innerHTML = displayList_buy[8];
                document.getElementById("r9weight").innerHTML = displayList_weight[8];
                document.getElementById("r9amount").innerHTML = displayList_amount[8];
                document.getElementById("r9stop").innerHTML = "10%";
                document.getElementById("r9current").innerHTML = displayList_returns[8];
              
                document.getElementById("r10name").innerHTML = displayList_name[9];
                document.getElementById("r10price").innerHTML = displayList_buy[9];
                document.getElementById("r10weight").innerHTML = displayList_weight[9];
                document.getElementById("r10amount").innerHTML = displayList_amount[9];
                document.getElementById("r10stop").innerHTML = "10%";
                document.getElementById("r10current").innerHTML = displayList_returns[9];
              
                console.log(displayList_name)
            })
            .catch((err) => {
                console.log(`Error fetching: ${err}`)
            });

            <!-- calculate investments
           
            function calc(form) {
                let displayList_amount = [];
                var A = document.getElementById("invest").value;
                displayList_buy.forEach((item) => {
                         displayList_amount.push(A/(item*10));
                })
                document.getElementById("r1amount").innerHTML = displayList_amount[0];
                document.getElementById("r2amount").innerHTML = displayList_amount[1];
                document.getElementById("r3amount").innerHTML = displayList_amount[2];
                document.getElementById("r4amount").innerHTML = displayList_amount[3];    
                document.getElementById("r5amount").innerHTML = displayList_amount[4];
                document.getElementById("r6amount").innerHTML = displayList_amount[5];
                document.getElementById("r7amount").innerHTML = displayList_amount[6];
                document.getElementById("r8amount").innerHTML = displayList_amount[7];
                document.getElementById("r9amount").innerHTML = displayList_amount[8];
                document.getElementById("r10amount").innerHTML = displayList_amount[9];
                return false;
                }
           
           
           
           
           

    var ctx = document.getElementById("chart-bars").getContext("2d");

    new Chart(ctx, {
      type: "bar",
      data: {
        labels: ["Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
        datasets: [{
          label: "Sales",
          tension: 0.4,
          borderWidth: 0,
          borderRadius: 4,
          borderSkipped: false,
          backgroundColor: "#fff",
          data: [450, 200, 100, 220, 500, 100, 400, 230, 500],
          maxBarThickness: 6
        }, ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: false,
          }
        },
        interaction: {
          intersect: false,
          mode: 'index',
        },
        scales: {
          y: {
            grid: {
              drawBorder: false,
              display: false,
              drawOnChartArea: false,
              drawTicks: false,
            },
            ticks: {
              suggestedMin: 0,
              suggestedMax: 500,
              beginAtZero: true,
              padding: 15,
              font: {
                size: 14,
                family: "Open Sans",
                style: 'normal',
                lineHeight: 2
              },
              color: "#fff"
            },
          },
          x: {
            grid: {
              drawBorder: false,
              display: false,
              drawOnChartArea: false,
              drawTicks: false
            },
            ticks: {
              display: false
            },
          },
        },
      },
    });


    var ctx2 = document.getElementById("chart-line").getContext("2d");

    var gradientStroke1 = ctx2.createLinearGradient(0, 230, 0, 50);

    gradientStroke1.addColorStop(1, 'rgba(203,12,159,0.2)');
    gradientStroke1.addColorStop(0.2, 'rgba(72,72,176,0.0)');
    gradientStroke1.addColorStop(0, 'rgba(203,12,159,0)'); //purple colors

    var gradientStroke2 = ctx2.createLinearGradient(0, 230, 0, 50);

    gradientStroke2.addColorStop(1, 'rgba(20,23,39,0.2)');
    gradientStroke2.addColorStop(0.2, 'rgba(72,72,176,0.0)');
    gradientStroke2.addColorStop(0, 'rgba(20,23,39,0)'); //purple colors

    new Chart(ctx2, {
      type: "line",
      data: {
        labels: ["Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],
        datasets: [{
            label: "Mobile apps",
            tension: 0.4,
            borderWidth: 0,
            pointRadius: 0,
            borderColor: "#cb0c9f",
            borderWidth: 3,
            backgroundColor: gradientStroke1,
            fill: true,
            data: [50, 40, 300, 220, 500, 250, 400, 230, 500],
            maxBarThickness: 6

          },
          {
            label: "Websites",
            tension: 0.4,
            borderWidth: 0,
            pointRadius: 0,
            borderColor: "#575f9a",
            borderWidth: 3,
            backgroundColor: gradientStroke2,
            fill: true,
            data: [30, 90, 40, 140, 290, 290, 340, 230, 400],
            maxBarThickness: 6
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: false,
          }
        },
        interaction: {
          intersect: false,
          mode: 'index',
        },
        scales: {
          y: {
            grid: {
              drawBorder: false,
              display: true,
              drawOnChartArea: true,
              drawTicks: false,
              borderDash: [5, 5]
            },
            ticks: {
              display: true,
              padding: 10,
              color: '#b2b9bf',
              font: {
                size: 11,
                family: "Open Sans",
                style: 'normal',
                lineHeight: 2
              },
            }
          },
          x: {
            grid: {
              drawBorder: false,
              display: false,
              drawOnChartArea: false,
              drawTicks: false,
              borderDash: [5, 5]
            },
            ticks: {
              display: true,
              color: '#b2b9bf',
              padding: 20,
              font: {
                size: 11,
                family: "Open Sans",
                style: 'normal',
                lineHeight: 2
              },
            }
          },
        },
      },
    });
          

    
    

  </script>
{% endblock javascripts %}
